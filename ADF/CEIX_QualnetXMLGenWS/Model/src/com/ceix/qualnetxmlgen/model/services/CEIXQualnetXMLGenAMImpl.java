package com.ceix.qualnetxmlgen.model.services;


import com.ceix.qualnetxmlgen.model.services.common.CEIXQualnetXMLGenAM;
import com.ceix.qualnetxmlgen.model.view.QualityMetricsReportVOImpl;
import com.ceix.qualnetxmlgen.model.view.WSResultPVOImpl;
import com.ceix.qualnetxmlgen.xmlbuilder.QualnetXMLGenerator;

import java.util.List;
import java.util.logging.Level;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.server.ApplicationModuleImpl;
import oracle.jbo.server.ViewObjectImpl;
import oracle.jbo.server.ViewRowImpl;


// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Tue May 15 16:31:49 IST 2018
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class CEIXQualnetXMLGenAMImpl extends ApplicationModuleImpl implements CEIXQualnetXMLGenAM {
    
    ADFLogger _logger = ADFLogger.createADFLogger(CEIXQualnetXMLGenAMImpl.class);
    
    /**
     * This is the default constructor (do not remove).
     */
    public CEIXQualnetXMLGenAMImpl() {
    }

    public List<ViewRowImpl> generateQualnetQualityReport() {
        
        _logger.log(Level.FINER, ">>generateQualnetQualityReport");
        String ftpDir ="CEIX_OracleERP/INTF/Outbound/OM/Qualnet/Out";
        //String ftpFileName = "quality_metrics";
        //ftpFileName = FTPWriterUtil.getCompleteFileName(ftpFileName);
        
        String ftpFileName = "quality_metrics.xml";
        /*isDev: if you are developing and have a D:/ drive, set isDev=true. 
        Before deploying to SX change it to false.*/
        boolean isDev=false;
        ViewObjectImpl voData = this.getQualityMetricsReport1();
        WSResultPVOImpl resultVo = this.getWSResultP1();
        
        QualnetXMLGenerator gen = new QualnetXMLGenerator(voData,ftpDir,ftpFileName,isDev,resultVo);
        List<ViewRowImpl> lstResult = gen.generate();
        
        _logger.log(Level.FINER, "<<generateQualnetQualityReport");
        return lstResult;

    }
    
    public List<ViewRowImpl> generateQualnetSTSRailScheduleReport() {
        
        _logger.log(Level.FINER, ">>generateQualnetSTSRailScheduleReport");
        String ftpDir ="CEIX_OracleERP/INTF/Outbound/OM/Qualnet/Out";
        //String ftpFileName = "sts_rail_schedules";
        //ftpFileName = FTPWriterUtil.getCompleteFileName(ftpFileName);
        String ftpFileName = "sts_rail_schedules.xml";
        /*isDev: if you are developing and have a D:/ drive, set isDev=true. 
        Before deploying to SX change it to false.*/
        boolean isDev=false;
        //ViewObjectImpl voData = this.getCEIXStsRailSchedules1();
        
        ViewObjectImpl voData = getRailSchedulesReportCustomVO();
                                 
        WSResultPVOImpl resultVo = this.getWSResultP1();
        
        QualnetXMLGenerator gen = new QualnetXMLGenerator(voData,ftpDir,ftpFileName,isDev,resultVo);
        List<ViewRowImpl> lstResult = gen.generate();
        
        try
        {
            voData.remove();
        }
        catch(Exception e) {
            _logger.severe("Error while removing custom VO.",e);
        }
        
        _logger.log(Level.FINER, "<<generateQualnetSTSRailScheduleReport");
        return lstResult;

    }
    
    public ViewObjectImpl getRailSchedulesReportCustomVO() {
        
        ViewObjectImpl vo = (ViewObjectImpl)
            this.createViewObjectFromQueryStmt("CEIXStsRailSchedulesVO", "SELECT * FROM CEIX_VW_QUALNT_RAILSCH_XML");
        short fetchSize = 200;
        vo.setFetchSize(fetchSize);
        vo.executeQuery();
        return vo;
        
    }


    /**
     * Container's getter for WSResultP1.
     * @return WSResultP1
     */
    public WSResultPVOImpl getWSResultP1() {
        return (WSResultPVOImpl)findViewObject("WSResultP1");
    }

    /**
     * Container's getter for QualityMetricsReport1.
     * @return QualityMetricsReport1
     */
    public QualityMetricsReportVOImpl getQualityMetricsReport1() {
        return (QualityMetricsReportVOImpl)findViewObject("QualityMetricsReport1");
    }
}
